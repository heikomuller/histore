

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>histore.archive.base module &mdash; History Store for Data Frames 0.4.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="histore.archive.merge module" href="histore.archive.merge.html" />
    <link rel="prev" title="histore.archive.store.base module" href="histore.archive.store.base.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> History Store for Data Frames
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">HISTORE - Data Frame History Store</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documents.html">Snapshot Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serialize.html">Json Serialization of Archives</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">histore</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="histore.html">histore package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="histore.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="histore.archive.html">histore.archive package</a></li>
<li class="toctree-l4"><a class="reference internal" href="histore.cli.html">histore.cli package</a></li>
<li class="toctree-l4"><a class="reference internal" href="histore.document.html">histore.document package</a></li>
<li class="toctree-l4"><a class="reference internal" href="histore.tests.html">histore.tests package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="histore.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">History Store for Data Frames</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">histore</a> &raquo;</li>
        
          <li><a href="histore.html">histore package</a> &raquo;</li>
        
          <li><a href="histore.archive.html">histore.archive package</a> &raquo;</li>
        
      <li>histore.archive.base module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/source/api/histore.archive.base.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-histore.archive.base">
<span id="histore-archive-base-module"></span><h1>histore.archive.base module<a class="headerlink" href="#module-histore.archive.base" title="Permalink to this headline">Â¶</a></h1>
<p>Archives are collections of snapshots of an evolving dataset.</p>
<dl class="py class">
<dt id="histore.archive.base.Archive">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">histore.archive.base.</span></code><code class="sig-name descname"><span class="pre">Archive</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.archive.store.base.html#histore.archive.store.base.ArchiveStore" title="histore.archive.store.base.ArchiveStore"><span class="pre">histore.archive.store.base.ArchiveStore</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputStream" title="histore.document.base.InputStream"><span class="pre">histore.document.base.InputStream</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.Document" title="histore.document.base.Document"><span class="pre">histore.document.base.Document</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputDescriptor" title="histore.document.base.InputDescriptor"><span class="pre">histore.document.base.InputDescriptor</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffersize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#histore.archive.base.Archive" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An archive maintains a list of dataset snapshots. Archive snapshots are
maintained by an archive store. The store provides a layer of abstraction
such that the archive object does not have to deal with the different ways
in which archives are managed by different systems.</p>
<dl class="py method">
<dt id="histore.archive.base.Archive.apply">
<code class="sig-name descname"><span class="pre">apply</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operators</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.document.operator.html#histore.document.operator.DatasetOperator" title="histore.document.operator.DatasetOperator"><span class="pre">histore.document.operator.DatasetOperator</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.document.operator.html#histore.document.operator.DatasetOperator" title="histore.document.operator.DatasetOperator"><span class="pre">histore.document.operator.DatasetOperator</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.archive.snapshot.html#histore.archive.snapshot.Snapshot" title="histore.archive.snapshot.Snapshot"><span class="pre">histore.archive.snapshot.Snapshot</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#histore.archive.base.Archive.apply" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply a given operator o a sequence of operators on a snapshot in
the archive.</p>
<p>The resulting snapshot(s) will directly merged into the archive. This
method allows to update data in an archive directly without the need
to checkout the snapshot first and then commit the modified version(s).</p>
<p>Returns list of handles for the created snapshots.</p>
<p>Note that there are some limitations for this method. Most importantly,
the order of rows cannot be modified and neither can it insert new rows
at this point. Columns can be added, moved, renamed, and deleted.
It is also important to note that if rows are deleted the position
information in the created snapshot will not reflect this accurately.
That is, the ordering of rows will still be correct, but the positions
are no longer absolute positions since some positin values may be
missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operators</strong> (<em>histore.document.operator.DatasetOperator or</em>) â     list of histore.document.stream.DatasetOperator
Operator(s) that is/are used to update the rows in a dataset
snapshot to create new snapshot(s) in this archive.</p></li>
<li><p><strong>origin</strong> (<em>int, default=None</em>) â Unique version identifier for the original snapshot that is being
updated. By default the last version is updated.</p></li>
<li><p><strong>validate</strong> (<em>bool, default=False</em>) â Validate that the resulting archive is in proper order before
committing the action.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="histore.archive.snapshot.html#histore.archive.snapshot.Snapshot" title="histore.archive.snapshot.Snapshot">histore.archive.snapshot.Snapshot</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.checkout">
<code class="sig-name descname"><span class="pre">checkout</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">pandas.core.frame.DataFrame</span><a class="headerlink" href="#histore.archive.base.Archive.checkout" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Access a dataset snapshot in the archive.</p>
<p>Retrieves the datset that was commited with the given version
identifier. Raises an error if the version identifier is unknown. If no
version identifier is given the last snapshot will be returned by
default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>version</strong> (<em>int, default=None</em>) â Unique version identifier. By default the last version is returned.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.commit">
<code class="sig-name descname"><span class="pre">commit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputStream" title="histore.document.base.InputStream"><span class="pre">histore.document.base.InputStream</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.Document" title="histore.document.base.Document"><span class="pre">histore.document.base.Document</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputDescriptor" title="histore.document.base.InputDescriptor"><span class="pre">histore.document.base.InputDescriptor</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffersize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">renamed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="histore.archive.snapshot.html#histore.archive.snapshot.Snapshot" title="histore.archive.snapshot.Snapshot"><span class="pre">histore.archive.snapshot.Snapshot</span></a><a class="headerlink" href="#histore.archive.base.Archive.commit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Commit a new snapshot to the dataset archive.</p>
<p>The given document represents the dataset snapshot that is being merged
into the archive. Returns the descriptor of the merged snapshot in the
new version of the archive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc</strong> (<em>histore.archive.base.InputDocument, or string</em>) â Input document representing the dataset snapshot that is being
merged into the archive.</p></li>
<li><p><strong>descriptor</strong> (<em>histore.document.base.InputDescriptor, default=None</em>) â Optional metadata for the created snapshot.</p></li>
<li><p><strong>sorted</strong> (<em>bool, default=False</em>) â Flag indicating if the document is sorted by the optional primary
key attributes. Ignored if the archive is not keyed.</p></li>
<li><p><strong>buffersize</strong> (<em>float, default=None</em>) â Maximum size (in bytes) for the memory buffer when sorting the
input document.</p></li>
<li><p><strong>validate</strong> (<em>bool, default=False</em>) â Validate that the resulting archive is in proper order before
committing the action.</p></li>
<li><p><strong>renamed</strong> (<em>list of tuple of str, str, default=None</em>) â Optional mapping of columns that have been renamed. Tuples contain
the old and the new columns name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="histore.archive.snapshot.html#histore.archive.snapshot.Snapshot" title="histore.archive.snapshot.Snapshot">histore.archive.snapshot.Snapshot</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.diff">
<code class="sig-name descname"><span class="pre">diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_version</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_version</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="histore.archive.provenance.archive.html#histore.archive.provenance.archive.SnapshotDiff" title="histore.archive.provenance.archive.SnapshotDiff"><span class="pre">histore.archive.provenance.archive.SnapshotDiff</span></a><a class="headerlink" href="#histore.archive.base.Archive.diff" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get provenance information representing the difference between two
dataset snapshots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_version</strong> (<em>int</em>) â Unique identifier for the original version.</p></li>
<li><p><strong>new_version</strong> (<em>int</em>) â Unique identifier for the version that the original version is
compared against.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="histore.archive.provenance.archive.html#histore.archive.provenance.archive.SnapshotDiff" title="histore.archive.provenance.archive.SnapshotDiff">histore.archive.provenance.archive.SnapshotDiff</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.is_empty">
<code class="sig-name descname"><span class="pre">is_empty</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="headerlink" href="#histore.archive.base.Archive.is_empty" title="Permalink to this definition">Â¶</a></dt>
<dd><p>True if the archive does not contain any snapshots yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.reader">
<code class="sig-name descname"><span class="pre">reader</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="histore.archive.reader.html#histore.archive.reader.ArchiveReader" title="histore.archive.reader.ArchiveReader"><span class="pre">histore.archive.reader.ArchiveReader</span></a><a class="headerlink" href="#histore.archive.base.Archive.reader" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get the row reader for this archive.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="histore.archive.reader.html#histore.archive.reader.ArchiveReader" title="histore.archive.reader.ArchiveReader">histore.archive.reader.ArchiveReader</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.rollback">
<code class="sig-name descname"><span class="pre">rollback</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#histore.archive.base.Archive.rollback" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Rollback the archive history to the snapshot with the given version
identifier.</p>
<p>Raises a ValueError if the given version identifier is invalid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>version</strong> (<em>int</em>) â Unique version identifier for the last version in the archive after
rollback.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> â </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.schema">
<code class="sig-name descname"><span class="pre">schema</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="histore.archive.schema.html#histore.archive.schema.ArchiveSchema" title="histore.archive.schema.ArchiveSchema"><span class="pre">histore.archive.schema.ArchiveSchema</span></a><a class="headerlink" href="#histore.archive.base.Archive.schema" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get the schema history for the archived dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="histore.archive.schema.html#histore.archive.schema.ArchiveSchema" title="histore.archive.schema.ArchiveSchema">histore.archive.schema.ArchiveSchema</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.snapshots">
<code class="sig-name descname"><span class="pre">snapshots</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="histore.archive.snapshot.html#histore.archive.snapshot.SnapshotListing" title="histore.archive.snapshot.SnapshotListing"><span class="pre">histore.archive.snapshot.SnapshotListing</span></a><a class="headerlink" href="#histore.archive.base.Archive.snapshots" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get listing of all snapshots in the archive.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="histore.archive.snapshot.html#histore.archive.snapshot.SnapshotListing" title="histore.archive.snapshot.SnapshotListing">histore.archive.snapshot.SnapshotListing</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="histore.archive.base.Archive.stream">
<code class="sig-name descname"><span class="pre">stream</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="histore.archive.reader.html#histore.archive.reader.SnapshotReader" title="histore.archive.reader.SnapshotReader"><span class="pre">histore.archive.reader.SnapshotReader</span></a><a class="headerlink" href="#histore.archive.base.Archive.stream" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get a stream reader for a dataset snapshot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>version</strong> (<em>int, default=None</em>) â Unique version identifier. By default the last version is used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="histore.archive.reader.html#histore.archive.reader.SnapshotReader" title="histore.archive.reader.SnapshotReader">histore.archive.reader.SnapshotReader</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="histore.archive.base.PersistentArchive">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">histore.archive.base.</span></code><code class="sig-name descname"><span class="pre">PersistentArchive</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.archive.store.base.html#histore.archive.store.base.ArchiveStore" title="histore.archive.store.base.ArchiveStore"><span class="pre">histore.archive.store.base.ArchiveStore</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basedir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">serializer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputStream" title="histore.document.base.InputStream"><span class="pre">histore.document.base.InputStream</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.Document" title="histore.document.base.Document"><span class="pre">histore.document.base.Document</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputDescriptor" title="histore.document.base.InputDescriptor"><span class="pre">histore.document.base.InputDescriptor</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffersize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#histore.archive.base.PersistentArchive" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#histore.archive.base.Archive" title="histore.archive.base.Archive"><code class="xref py py-class docutils literal notranslate"><span class="pre">histore.archive.base.Archive</span></code></a></p>
<p>Archive that persists all dataset snapshots in files on the file system.
All the data is maintained within a given directory on the file system.
This class is a wrapper for an archive with a persistent archive store. It
uses the default file system store.</p>
</dd></dl>

<dl class="py function">
<dt id="histore.archive.base.get_key_columns">
<code class="sig-prename descclassname"><span class="pre">histore.archive.base.</span></code><code class="sig-name descname"><span class="pre">get_key_columns</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.schema.html#histore.document.schema.Column" title="histore.document.schema.Column"><span class="pre">histore.document.schema.Column</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#histore.archive.base.get_key_columns" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get identifier for primary key columns.</p>
<p>Uses the archive schema merge method to get the identifiable columns for the
given schema. Then returns the identifier for the columns that match the
primary key columns.</p>
<p>Note that the primary key specification cannot reference columns that have
non-unique names. If a primary key column occurs more than once in the
resulting schema an error is raised. An error is also raised if the primary
key references a column that does not exist.</p>
<p>If the list of primary key columns is None or empty the result is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> (<em>list of string</em>) â Schema for the input document.</p></li>
<li><p><strong>primary_key</strong> (<em>list of string</em>) â Names of primary key columns. May be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="histore.archive.base.to_document">
<code class="sig-prename descclassname"><span class="pre">histore.archive.base.</span></code><code class="sig-name descname"><span class="pre">to_document</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputStream" title="histore.document.base.InputStream"><span class="pre">histore.document.base.InputStream</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.Document" title="histore.document.base.Document"><span class="pre">histore.document.base.Document</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="histore.document.base.html#histore.document.base.Document" title="histore.document.base.Document"><span class="pre">histore.document.base.Document</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="histore.document.base.html#histore.document.base.InputStream" title="histore.document.base.InputStream"><span class="pre">histore.document.base.InputStream</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#histore.archive.base.to_document" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Ensure that a given input document is either an instance of class
Document or InputStream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>doc</strong> (<em>histore.document.base.Document, pd.DataFrame,</em>) â     histore.document.csv.base.CSVFile, or string
Input document representing a dataset snapshot.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>histore.document.base.Document of histore.document.stream.InputStream</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="histore.archive.merge.html" class="btn btn-neutral float-right" title="histore.archive.merge module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="histore.archive.store.base.html" class="btn btn-neutral float-left" title="histore.archive.store.base module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2021, Heiko Mueller.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>